/**
 * FoodyLog Global Styles with shadcn/ui Integration
 * 
 * Custom FoodyLog theme with warm cream/brown palette and green accents.
 * Implements the design system from FoodyLog_UI_UX_Design.md
 */

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* FoodyLog Custom Theme - Light Mode */
    --background: 30 43% 90%;
    /* #f0e5d9 - Warm cream background */
    --foreground: 30 12% 16%;
    /* #2f2a25 - Dark brown text */
    --card: 30 43% 90%;
    /* #f0e5d9 - Same as background for cards */
    --card-foreground: 30 12% 16%;
    /* #2f2a25 - Dark brown text on cards */
    --popover: 30 43% 90%;
    /* #f0e5d9 - Popover background */
    --popover-foreground: 30 12% 16%;
    /* #2f2a25 - Popover text */
    --primary: 139 35% 35%;
    /* #4a7c5d - Darker green for better contrast */
    --primary-foreground: 0 0% 100%;
    /* #ffffff - White text on green */
    --secondary: 30 33% 80%;
    /* #d4c2b2 - Subtle brown for secondary elements */
    --secondary-foreground: 30 12% 16%;
    /* #2f2a25 - Dark text on secondary */
    --muted: 30 40% 87%;
    /* #e3d5c5 - Muted background for hover states */
    --muted-foreground: 30 12% 16%;
    /* #2f2a25 - Text on muted backgrounds */
    --accent: 139 35% 35%;
    /* #4a7c5d - Same as primary for consistency */
    --accent-foreground: 0 0% 100%;
    /* #ffffff - White text on accent */
    --destructive: 0 84% 50%;
    /* #dc2626 - Darker red for better contrast */
    --destructive-foreground: 0 0% 100%;
    /* #ffffff - White text on red */
    --border: 30 33% 80%;
    /* #d4c2b2 - Subtle borders */
    --input: 30 40% 87%;
    /* #e3d5c5 - Input background */
    --ring: 139 29% 42%;
    /* #5da271 - Focus ring color */
    --radius: 0.5rem;
    /* 8px border radius */

    /* FoodyLog Rating Colors - WCAG AA Compliant */
    --rating-excellent: 139 45% 28%;
    /* #366142 - Darker green for excellent ratings */
    --rating-great: 139 40% 30%;
    /* #3d6b4a - Darker green for great ratings */
    --rating-good: 45 85% 27%;
    /* #826907 - Darkest yellow for good ratings */
    --rating-poor: 25 90% 35%;
    /* #b84a00 - Darker orange for poor ratings */
    --rating-bad: 0 84% 42%;
    /* #c41c1c - Darker red for bad ratings */
  }

  .dark {
    /* FoodyLog Custom Theme - Dark Mode */
    --background: 24 7% 12%;
    /* #1e1b1a - Dark brown background */
    --foreground: 30 43% 90%;
    /* #f0e5d9 - Cream text */
    --card: 24 7% 12%;
    /* #1e1b1a - Same as background for cards */
    --card-foreground: 30 43% 90%;
    /* #f0e5d9 - Cream text on cards */
    --popover: 24 7% 12%;
    /* #1e1b1a - Popover background */
    --popover-foreground: 30 43% 90%;
    /* #f0e5d9 - Popover text */
    --primary: 139 45% 35%;
    /* #3f8653 - Even darker green for better contrast in dark mode */
    --primary-foreground: 0 0% 100%;
    /* #ffffff - White text on green for better contrast */
    --secondary: 34 12% 22%;
    /* #453f3b - Darker secondary */
    --secondary-foreground: 30 43% 90%;
    /* #f0e5d9 - Cream text on secondary */
    --muted: 28 9% 16%;
    /* #2a2522 - Muted background */
    --muted-foreground: 30 43% 90%;
    /* #f0e5d9 - Cream text on muted */
    --accent: 139 45% 35%;
    /* #3f8653 - Same as primary */
    --accent-foreground: 0 0% 100%;
    /* #ffffff - White text on accent for better contrast */
    --destructive: 0 84% 50%;
    /* #dc2626 - Darker red for better contrast */
    --destructive-foreground: 0 0% 100%;
    /* #ffffff - White text on red */
    --border: 34 12% 22%;
    /* #453f3b - Darker borders */
    --input: 28 9% 16%;
    /* #2a2522 - Darker input background */
    --ring: 139 45% 35%;
    /* #3f8653 - Focus ring color */

    /* FoodyLog Rating Colors - Dark Mode Adjusted */
    --rating-excellent: 139 35% 50%;
    /* Brighter green for dark mode */
    --rating-great: 139 29% 45%;
    /* Adjusted green */
    --rating-good: 45 93% 55%;
    /* Brighter yellow */
    --rating-poor: 25 95% 60%;
    /* Brighter orange */
    --rating-bad: 0 84% 65%;
    /* Brighter red */
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
  }

  /* FoodyLog specific base styles */
  #root {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  /* Enhanced focus styles for accessibility (WCAG 2.1 AA) */
  :focus-visible {
    @apply outline-none ring-2 ring-ring ring-offset-2;
  }

  /* Mobile-first responsive images */
  img,
  picture,
  video,
  canvas,
  svg {
    display: block;
    max-width: 100%;
  }

  /* Form elements inherit font */
  input,
  button,
  textarea,
  select {
    font: inherit;
  }

  button {
    cursor: pointer;
  }

  /* FoodyLog custom animations */
  .meal-card-hover {
    @apply transition-all duration-200 hover:shadow-lg hover:-translate-y-0.5;
  }

  .photo-capture-flash {
    @apply animate-shutter;
  }

  .star-selected {
    @apply animate-star-fill;
  }

  .input-error {
    @apply animate-shake border-destructive;
  }
}

/* PWA safe area handling for mobile devices */
@supports (padding: max(0px)) {
  .safe-area-inset-top {
    padding-top: max(var(--spacing-4), env(safe-area-inset-top));
  }

  .safe-area-inset-bottom {
    padding-bottom: max(var(--spacing-4), env(safe-area-inset-bottom));
  }

  .safe-area-inset-left {
    padding-left: max(var(--spacing-4), env(safe-area-inset-left));
  }

  .safe-area-inset-right {
    padding-right: max(var(--spacing-4), env(safe-area-inset-right));
  }
}

/* FoodyLog Layout Components */
@layer components {

  /* App Layout - Main container with CSS Grid */
  .app-layout {
    @apply min-h-screen bg-background text-foreground;
    display: grid;
    grid-template-rows: auto 1fr;
    grid-template-areas:
      "header"
      "main";
  }

  .app-layout__main {
    grid-area: main;
    @apply flex flex-col;
  }

  .app-layout__content {
    @apply flex-1 w-full max-w-4xl mx-auto px-4 py-6;
    /* Add bottom padding to account for fixed navigation */
    padding-bottom: calc(1.5rem + 60px + max(0.5rem, env(safe-area-inset-bottom)));
  }

  /* Header Component */
  .header {
    grid-area: header;
    @apply sticky top-0 z-50 w-full border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60;
    /* Safe area handling for mobile notches */
    padding-top: max(1rem, env(safe-area-inset-top));
  }

  .header__container {
    @apply flex items-center justify-between max-w-4xl mx-auto px-4;
    /* Consistent 60px height as per task requirements */
    height: 60px;
  }

  .header__brand {
    @apply flex items-center space-x-2;
  }

  .header__logo {
    @apply text-2xl;
  }

  .header__title {
    @apply text-xl font-bold text-foreground;
  }

  .header__actions {
    @apply flex items-center space-x-2;
  }

  /* Navigation Component - Mobile-first bottom navigation */
  .navigation {
    @apply fixed bottom-0 left-0 right-0 z-40 border-t border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60;
    /* Safe area handling for mobile home indicators */
    padding-bottom: max(0.5rem, env(safe-area-inset-bottom));
  }

  .navigation__container {
    @apply flex items-center justify-around max-w-4xl mx-auto px-2 py-2;
  }

  .navigation__item {
    @apply relative flex flex-col items-center justify-center min-w-0 flex-1 px-2 py-2 text-xs font-medium rounded-lg;
    /* Minimum touch target size for accessibility (44px) */
    min-height: 44px;
    /* Smooth transitions for all interactive states */
    transition: all 0.2s ease-in-out;
    /* Enhanced focus styles for accessibility */
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2;
  }

  .navigation__item:hover {
    @apply bg-muted;
    /* Subtle scale effect on hover for better feedback */
    transform: scale(1.02);
  }

  .navigation__item:active {
    /* Pressed state feedback */
    transform: scale(0.98);
  }

  .navigation__item--active {
    @apply text-primary;
    /* Enhanced active state with subtle background */
    @apply bg-primary/10;
  }

  .navigation__item--active:hover {
    @apply bg-primary/15;
  }

  .navigation__item--primary {
    @apply bg-primary text-primary-foreground rounded-full mx-2 px-4;
    /* Enhanced shadow for primary button */
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .navigation__item--primary:hover {
    @apply bg-primary/90;
    /* Enhanced hover effect for primary button */
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .navigation__item--primary:active {
    transform: scale(0.95);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
  }

  .navigation__icon {
    @apply flex items-center justify-center mb-1;
  }

  .navigation__label {
    @apply text-xs font-medium leading-none truncate;
  }

  .navigation__indicator {
    @apply absolute -top-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-primary rounded-full;
    /* Smooth animation for active indicator */
    animation: pulse 2s infinite;
  }

  /* Pulse animation for active indicator */
  @keyframes pulse {
    0%, 100% {
      opacity: 1;
      transform: translate(-50%, 0) scale(1);
    }
    50% {
      opacity: 0.7;
      transform: translate(-50%, 0) scale(1.2);
    }
  }

  /* Page Transition Components */
  .page-transition-container {
    @apply relative w-full h-full;
  }

  .page-transition {
    @apply w-full h-full opacity-0;
    animation: simpleFadeIn 0.15s ease-out forwards;
  }

  /* Enhanced Navigation Micro-interactions */
  .navigation__item {
    @apply relative overflow-hidden;
    /* Add ripple effect container */
  }

  .navigation__item::before {
    content: '';
    @apply absolute inset-0 bg-primary/10 rounded-lg;
    @apply scale-0 opacity-0 transition-all duration-200;
    transform-origin: center;
  }

  .navigation__item:hover::before {
    @apply scale-100 opacity-100;
  }

  .navigation__item:active::before {
    @apply scale-95 opacity-75;
  }

  /* Enhanced focus states for better accessibility */
  .navigation__item:focus-visible {
    @apply outline-none ring-2 ring-primary ring-offset-2 ring-offset-background;
    /* Add subtle glow effect */
    box-shadow: 0 0 0 2px hsl(var(--background)), 0 0 0 4px hsl(var(--primary)), 0 0 8px hsl(var(--primary) / 0.3);
  }

  /* Primary button enhanced interactions */
  .navigation__item--primary {
    @apply relative overflow-hidden;
    /* Enhanced shadow and transform effects */
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .navigation__item--primary::after {
    content: '';
    @apply absolute inset-0 bg-white/20 rounded-full;
    @apply scale-0 opacity-0;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform-origin: center;
  }

  .navigation__item--primary:hover::after {
    @apply scale-100 opacity-100;
  }

  .navigation__item--primary:active {
    transform: scale(0.95);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
  }

  /* Ripple effect for touch interactions */
  .navigation__item.ripple-effect::before {
    @apply absolute inset-0 bg-primary/20 rounded-lg pointer-events-none;
    @apply scale-0 opacity-60;
    animation: ripple 0.6s linear;
  }

  /* Responsive adjustments for larger screens */
  @media (min-width: 768px) {
    .app-layout__content {
      @apply px-6 py-8;
    }

    .header__container {
      @apply px-6;
    }

    /* Keep navigation visible on all screen sizes for now */
    /* TODO: Add sidebar navigation for desktop in future iterations */

    /* Same simple transition for larger screens */
    .page-transition {
      animation: simpleFadeIn 0.12s ease-out forwards;
    }
  }

  @media (min-width: 1024px) {
    .app-layout__content {
      @apply px-8;
    }

    .header__container {
      @apply px-8;
    }

    /* Faster transitions for desktop */
    .page-transition {
      animation: simpleFadeIn 0.1s ease-out forwards;
    }
  }

  /* Reduced motion preferences - WCAG 2.1 AA compliance */
  @media (prefers-reduced-motion: reduce) {
    .page-transition,
    .navigation__item,
    .navigation__item--primary,
    .navigation__item::before,
    .navigation__item--primary::after {
      transition: none !important;
      animation: none !important;
    }

    .page-transition {
      animation: none !important;
      @apply opacity-100;
    }



    /* Keep essential animations but reduce intensity */
    .animate-pulse {
      animation: none !important;
    }

    .animate-spin {
      animation: spin 2s linear infinite !important; /* Slower spin for loading indicators */
    }

    /* Maintain focus indicators for accessibility */
    .navigation__item:focus-visible {
      transition: box-shadow 0.1s ease-out !important;
    }
  }
}

/* Custom animations for FoodyLog */
@layer utilities {
  @keyframes shutter {
    0% {
      opacity: 1;
    }

    50% {
      opacity: 0.3;
    }

    100% {
      opacity: 1;
    }
  }

  @keyframes star-fill {
    0% {
      transform: scale(1);
    }

    50% {
      transform: scale(1.2);
    }

    100% {
      transform: scale(1);
    }
  }

  @keyframes shake {

    0%,
    100% {
      transform: translateX(0);
    }

    25% {
      transform: translateX(-5px);
    }

    75% {
      transform: translateX(5px);
    }
  }

  /* Simple page transition animation */
  @keyframes simpleFadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }



  /* Enhanced navigation micro-interactions */
  @keyframes navItemPress {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(0.95);
    }
    100% {
      transform: scale(1);
    }
  }

  @keyframes navItemHover {
    0% {
      transform: scale(1);
    }
    100% {
      transform: scale(1.05);
    }
  }

  /* Ripple effect for touch interactions */
  @keyframes ripple {
    0% {
      transform: scale(0);
      opacity: 0.6;
    }
    100% {
      transform: scale(4);
      opacity: 0;
    }
  }

  .animate-shutter {
    animation: shutter 0.3s ease-in-out;
  }

  .animate-star-fill {
    animation: star-fill 0.3s ease-in-out;
  }

  .animate-shake {
    animation: shake 0.5s ease-in-out;
  }

  .animate-simple-fade-in {
    animation: simpleFadeIn 0.15s ease-out;
  }

  .animate-nav-press {
    animation: navItemPress 0.1s ease-in-out;
  }

  .animate-nav-hover {
    animation: navItemHover 0.2s ease-out;
  }

  .animate-ripple {
    animation: ripple 0.6s linear;
  }
}

/* Utility classes */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}/**
 *
 FoodyLog Accessibility Enhancements
 * 
 * Additional CSS for comprehensive accessibility support.
 * Ensures WCAG 2.1 AA compliance across all components.
 */

/* Screen reader only content */
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

.sr-only-focusable:focus,
.sr-only-focusable:active {
  position: static !important;
  width: auto !important;
  height: auto !important;
  padding: inherit !important;
  margin: inherit !important;
  overflow: visible !important;
  clip: auto !important;
  white-space: inherit !important;
}

/* Skip link for keyboard navigation */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: hsl(var(--background));
  color: hsl(var(--foreground));
  padding: 8px 12px;
  text-decoration: none;
  border-radius: 4px;
  border: 2px solid hsl(var(--border));
  z-index: 1000;
  font-weight: 500;
  transition: top 150ms ease-in-out;
}

.skip-link:focus {
  top: 6px;
}

/* Enhanced focus indicators */
.js-focus-visible button:focus:not(.focus-visible),
.js-focus-visible input:focus:not(.focus-visible),
.js-focus-visible textarea:focus:not(.focus-visible),
.js-focus-visible select:focus:not(.focus-visible),
.js-focus-visible a:focus:not(.focus-visible),
.js-focus-visible [tabindex]:focus:not(.focus-visible) {
  outline: none;
}

/* High contrast mode support */
@media (forced-colors: active) {
  .skip-link {
    background: ButtonFace;
    color: ButtonText;
    border-color: ButtonBorder;
  }
  
  button,
  input,
  textarea,
  select {
    border-color: ButtonBorder;
  }
  
  button:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible,
  a:focus-visible,
  [tabindex]:focus-visible {
    outline: 2px solid Highlight;
    outline-offset: 2px;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Touch target minimum sizes */
button,
input[type="button"],
input[type="submit"],
input[type="reset"],
input[type="checkbox"],
input[type="radio"],
a[href],
[role="button"],
[role="link"],
[tabindex="0"] {
  min-width: 44px;
  min-height: 44px;
}

/* Exception for inline elements */
span[role="button"],
span[role="link"] {
  display: inline-block;
  padding: 8px;
}

/* Navigation accessibility enhancements */
.navigation {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: hsl(var(--background));
  border-top: 1px solid hsl(var(--border));
  z-index: 50;
  padding-bottom: env(safe-area-inset-bottom);
}

.navigation__container {
  display: flex;
  justify-content: space-around;
  align-items: center;
  max-width: 100%;
  margin: 0 auto;
  padding: 8px 16px;
}

.navigation__item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 8px 12px;
  min-width: 44px;
  min-height: 44px;
  border-radius: 8px;
  text-decoration: none;
  transition: all 200ms ease-in-out;
  position: relative;
  color: hsl(var(--muted-foreground));
}

.navigation__item:hover {
  background: hsl(var(--muted));
  color: hsl(var(--foreground));
}

.navigation__item--active {
  color: hsl(var(--primary));
  background: hsl(var(--primary) / 0.1);
}

.navigation__item--primary {
  background: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
}

.navigation__item--primary:hover {
  background: hsl(var(--primary) / 0.9);
}

.navigation__icon {
  margin-bottom: 2px;
}

.navigation__label {
  font-size: 0.75rem;
  font-weight: 500;
  line-height: 1;
}

.navigation__indicator {
  position: absolute;
  top: 4px;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 4px;
  background: hsl(var(--primary));
  border-radius: 50%;
}

/* Form accessibility enhancements */
label {
  font-weight: 500;
  color: hsl(var(--foreground));
}

input:invalid {
  border-color: hsl(var(--destructive));
}

input:valid:not(:placeholder-shown) {
  border-color: hsl(139 35% 35%);
}

/* Error and success states */
[role="alert"] {
  color: hsl(var(--destructive));
  font-weight: 500;
}

.text-success {
  color: hsl(139 35% 35%);
}

/* Keyboard navigation indicators */
[tabindex="0"]:focus-visible,
[tabindex="-1"]:focus-visible,
button:focus-visible,
input:focus-visible,
textarea:focus-visible,
select:focus-visible,
a:focus-visible {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
  border-radius: 4px;
}

/* High contrast focus indicators */
@media (prefers-contrast: high) {
  [tabindex="0"]:focus-visible,
  [tabindex="-1"]:focus-visible,
  button:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible,
  a:focus-visible {
    outline-width: 3px;
    outline-offset: 1px;
  }
}